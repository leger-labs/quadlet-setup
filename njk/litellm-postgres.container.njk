{% import "macros.njk" as m -%}
[Unit]
Description=PostgreSQL database for LiteLLM
After=network-online.target {{ infrastructure.network.name }}.network.service
Requires={{ infrastructure.network.name }}.network.service

[Container]
Image={{ infrastructure.services.litellm_postgres.image }}
AutoUpdate=registry
ContainerName={{ infrastructure.services.litellm_postgres.container_name }}

# ═════════════════════════════════════════════════════════════════════════════
# 🌐 NETWORK - Internal only, no published ports
# ═════════════════════════════════════════════════════════════════════════════
Network={{ infrastructure.network.name }}.network

# ═════════════════════════════════════════════════════════════════════════════
# 🔐 ENVIRONMENT - No password needed (internal only, trust auth)
# ═════════════════════════════════════════════════════════════════════════════
{{ m.postgresEnv(infrastructure.services.litellm_postgres.db_name, infrastructure.services.litellm_postgres.db_user, enable_vector=true) }}

# ═════════════════════════════════════════════════════════════════════════════
# 💾 VOLUME
# ═════════════════════════════════════════════════════════════════════════════
{{ m.volumeMount(infrastructure.services.litellm_postgres.volume, "/var/lib/postgresql/data") }}

# ═════════════════════════════════════════════════════════════════════════════
# 🔧 HEALTH CHECK
# ═════════════════════════════════════════════════════════════════════════════
{{ m.postgresHealthCheck(infrastructure.services.litellm_postgres.db_user) }}

# ═════════════════════════════════════════════════════════════════════════════
# 🚀 SERVICE
# ═════════════════════════════════════════════════════════════════════════════
{{ m.serviceSection(timeout=900) }}

[Install]
# No WantedBy - dependencies via After/Requires
