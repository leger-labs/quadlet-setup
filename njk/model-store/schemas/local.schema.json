{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://leger.run/schemas/model-store/local.schema.json",
  "title": "Local Model Definition",
  "description": "Schema for local GGUF model definitions in the Leger Model Store",
  "type": "object",
  "required": [
    "id",
    "name",
    "model_uri",
    "quantization",
    "ram_required_gb",
    "context_window",
    "group"
  ],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for the model (used in blueprint.json)",
      "pattern": "^[a-z0-9-]+$",
      "examples": ["qwen3-4b", "gpt-oss-20b", "qwen3-embedding-8b"]
    },
    "name": {
      "type": "string",
      "description": "Display name for UI",
      "minLength": 1,
      "examples": ["Qwen3 4B", "GPT-OSS 20B", "Qwen3 Embedding 8B"]
    },
    "model_uri": {
      "type": "string",
      "description": "HuggingFace GGUF URI (huggingface://repo/file.gguf)",
      "pattern": "^huggingface://[a-zA-Z0-9/_.-]+\\.gguf$",
      "examples": ["huggingface://Qwen/Qwen3-4B-GGUF/qwen3-4b-q4_k_m.gguf"]
    },
    "quantization": {
      "type": "string",
      "description": "GGUF quantization format",
      "enum": ["Q2_K", "Q3_K", "Q3_K_S", "Q3_K_M", "Q3_K_L", "Q3_K_XL", "Q4_0", "Q4_1", "Q4_K", "Q4_K_S", "Q4_K_M", "Q4_K_L", "Q4_K_XL", "Q5_0", "Q5_1", "Q5_K", "Q5_K_S", "Q5_K_M", "Q6_K", "Q8_0", "F16", "BF16", "F32"],
      "examples": ["Q4_K_M", "Q8_0", "BF16"]
    },
    "ram_required_gb": {
      "type": "number",
      "description": "RAM required in GB",
      "minimum": 0.1,
      "maximum": 256,
      "examples": [1, 3, 16, 80]
    },
    "context_window": {
      "type": "integer",
      "description": "Maximum context window in tokens",
      "minimum": 512,
      "examples": [4096, 8192, 32768, 131072, 10485760]
    },
    "group": {
      "type": "string",
      "description": "Model group for swapping behavior",
      "enum": ["task", "balanced", "heavy", "embeddings"],
      "examples": ["task", "heavy", "embeddings"]
    },
    "description": {
      "type": "string",
      "description": "Textual description of the model (can be empty)",
      "examples": ["Balanced task model - tags, queries, analysis"]
    },
    "icon": {
      "type": "string",
      "description": "Path to family logo in assets/ folder",
      "pattern": "^assets/[a-z0-9-]+\\.(svg|png|jpg)$",
      "examples": ["assets/qwen.svg", "assets/llama.svg"]
    },
    "family": {
      "type": "string",
      "description": "Model family",
      "enum": ["qwen", "llama", "mistral", "phi", "gemma", "granite", "gpt-oss", "deepseek", "nomic", "voyage"],
      "examples": ["qwen", "llama", "gpt-oss"]
    },
    "capabilities": {
      "type": "array",
      "description": "List of model capabilities",
      "items": {
        "type": "string",
        "enum": ["chat", "code", "reasoning", "embeddings", "vision", "multimodal", "long-context"]
      },
      "uniqueItems": true,
      "examples": [["chat", "code"], ["embeddings"]]
    },
    "ctx_size": {
      "type": "integer",
      "description": "Practical context size for optimal performance",
      "minimum": 512,
      "examples": [4096, 8192, 65536]
    },
    "ttl": {
      "type": "integer",
      "description": "Time to live in seconds (0 = never unload)",
      "minimum": 0,
      "examples": [0, 600, 900, 1800]
    },
    "hf_repo": {
      "type": "string",
      "description": "HuggingFace repository path",
      "pattern": "^[a-zA-Z0-9_-]+/[a-zA-Z0-9_.-]+$",
      "examples": ["Qwen/Qwen3-4B-GGUF", "openai/gpt-oss-20b-GGUF"]
    },
    "hf_file": {
      "type": "string",
      "description": "Specific GGUF file in HuggingFace repo",
      "pattern": "^[a-zA-Z0-9_.-]+\\.gguf$",
      "examples": ["qwen3-4b-q4_k_m.gguf", "gpt-oss-20b-q4_k_m.gguf"]
    },
    "aliases": {
      "type": "array",
      "description": "Alternative names for the model",
      "items": {
        "type": "string"
      },
      "uniqueItems": true,
      "examples": [["gpt-oss", "gpt-oss-small"], ["thinking", "qwen-thinking"]]
    },
    "shortname": {
      "type": "string",
      "description": "Short identifier for the model",
      "pattern": "^[a-z0-9-]+$",
      "examples": ["qwen3-tiny", "qwen3-medium", "granite-micro"]
    },
    "embedding_dimension": {
      "type": "integer",
      "description": "Embedding vector dimension (for embedding models only)",
      "minimum": 128,
      "examples": [1024, 2048, 4096]
    },
    "vulkan_driver": {
      "type": "string",
      "description": "Preferred Vulkan driver for AMD GPUs",
      "enum": ["RADV", "AMDVLK"],
      "examples": ["RADV", "AMDVLK"]
    },
    "flash_attn": {
      "type": "boolean",
      "description": "Whether to use flash attention",
      "default": true
    },
    "batch_size": {
      "type": "integer",
      "description": "Batch size for inference",
      "minimum": 1,
      "examples": [512, 2048]
    },
    "deprecated": {
      "type": "boolean",
      "description": "Whether this model is deprecated",
      "default": false
    },
    "replacement": {
      "type": "string",
      "description": "Model ID to use instead (if deprecated)",
      "pattern": "^[a-z0-9-]+$",
      "examples": ["qwen3-4b", "gpt-oss-20b"]
    },
    "deprecation_reason": {
      "type": "string",
      "description": "Reason for deprecation",
      "examples": ["Superseded by newer quantization", "Better model available"]
    },
    "enabled": {
      "type": "boolean",
      "description": "Whether model is enabled by default in blueprints",
      "default": true
    },
    "use_cases": {
      "type": "array",
      "description": "Recommended use cases",
      "items": {
        "type": "string"
      },
      "examples": [["Title generation", "Quick Q&A"], ["Code generation", "Debugging"]]
    },
    "notes": {
      "type": "string",
      "description": "Additional notes about the model",
      "examples": ["Never unloads - always ready", "Can theoretically do 1M context but slow"]
    },
    "performance": {
      "type": "object",
      "description": "Performance metrics",
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
